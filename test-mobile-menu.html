<!DOCTYPE html>
<html lang="et">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Mobile Menu - MTÃœ Kaiu Kodukant</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com/"></script>

    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">

    <!-- Tailwind Configuration -->
    <script src="/js/tailwind-config.js"></script>
    <script>
        tailwind.config = window.tailwindConfig;
    </script>

    <!-- Custom Styles -->
    <link rel="stylesheet" href="/css/styles.css">

    <style>
        .debug-info {
            position: fixed;
            bottom: 10px;
            right: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            z-index: 9999;
        }
    </style>
</head>
<body class="bg-silk text-cascades">

    <!-- Header placeholder - loaded dynamically -->
    <div id="header-placeholder"></div>

    <!-- Debug Info -->
    <div class="debug-info" id="debug-info">
        <div>Screen Width: <span id="screen-width"></span>px</div>
        <div>Menu State: <span id="menu-state">hidden</span></div>
        <div>Hamburger Found: <span id="hamburger-found">checking...</span></div>
        <div>Menu Found: <span id="menu-found">checking...</span></div>
        <div>Events Attached: <span id="events-attached">0</span></div>
    </div>

    <!-- Main Content -->
    <main class="p-8">
        <h1 class="text-3xl font-bold mb-4">Mobile Menu Test Page</h1>
        <p class="mb-4">This page helps debug mobile menu functionality.</p>

        <div class="bg-white p-4 rounded-lg shadow mb-4">
            <h2 class="text-xl font-semibold mb-2">Instructions:</h2>
            <ol class="list-decimal list-inside space-y-2">
                <li>Resize your browser window to mobile width (< 768px)</li>
                <li>Click the hamburger menu button in the top right</li>
                <li>The mobile menu should appear/disappear</li>
                <li>Check the debug info in the bottom right corner</li>
                <li>Open browser console (F12) to see log messages</li>
            </ol>
        </div>

        <div class="bg-yellow-100 p-4 rounded-lg">
            <h3 class="font-semibold mb-2">Console Output:</h3>
            <p>Check your browser's console for detailed debugging information.</p>
        </div>
    </main>

    <!-- Footer placeholder - loaded dynamically -->
    <div id="footer-placeholder"></div>

    <!-- Common JavaScript with extra debugging -->
    <script src="/js/common.js"></script>

    <script>
        // Debug script
        function updateDebugInfo() {
            const debugInfo = document.getElementById('debug-info');
            const screenWidth = document.getElementById('screen-width');
            const menuState = document.getElementById('menu-state');
            const hamburgerFound = document.getElementById('hamburger-found');
            const menuFound = document.getElementById('menu-found');
            const eventsAttached = document.getElementById('events-attached');

            // Update screen width
            screenWidth.textContent = window.innerWidth;

            // Check for hamburger and menu
            const hamburger = document.getElementById('hamburger-menu');
            const mobileMenu = document.getElementById('mobile-menu');

            hamburgerFound.textContent = hamburger ? 'yes' : 'no';
            menuFound.textContent = mobileMenu ? 'yes' : 'no';

            if (mobileMenu) {
                menuState.textContent = mobileMenu.classList.contains('hidden') ? 'hidden' : 'visible';
            }

            // Check if hamburger is visible
            if (hamburger) {
                const isVisible = window.getComputedStyle(hamburger).display !== 'none';
                hamburgerFound.textContent = isVisible ? 'yes (visible)' : 'yes (hidden by CSS)';
            }
        }

        // Update debug info every 500ms
        setInterval(updateDebugInfo, 500);

        // Log when header is loaded
        const observer = new MutationObserver((mutations) => {
            mutations.forEach((mutation) => {
                if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {
                    const headerPlaceholder = document.getElementById('header-placeholder');
                    if (headerPlaceholder && headerPlaceholder.children.length > 0) {
                        console.log('Header loaded!');
                        updateDebugInfo();
                    }
                }
            });
        });

        observer.observe(document.getElementById('header-placeholder'), { childList: true });

        // Add resize listener
        window.addEventListener('resize', updateDebugInfo);

        // Initial update
        updateDebugInfo();

        // Override setupMobileMenu to add more logging
        const originalSetupMobileMenu = window.setupMobileMenu;
        window.setupMobileMenu = function() {
            console.log('setupMobileMenu called');
            originalSetupMobileMenu();
            console.log('setupMobileMenu completed');
            updateDebugInfo();
        };
    </script>
</body>
</html>